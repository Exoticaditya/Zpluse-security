# Railway Environment Variables Verification Checklist

**Project**: SGMS Backend  
**Platform**: Railway.app  
**Date**: February 18, 2026  

---

## üîê REQUIRED ENVIRONMENT VARIABLES

### How to Access Railway Variables

1. Go to [railway.app](https://railway.app)
2. Select your `sgms-backend` project
3. Click on the backend service
4. Click **"Variables"** tab
5. Verify the following variables exist:

---

## ‚úÖ VERIFICATION CHECKLIST

### 1. SPRING_PROFILES_ACTIVE
```bash
SPRING_PROFILES_ACTIVE=prod
```
- **Status**: [ ] SET / [ ] MISSING
- **Purpose**: Activates production configuration profile
- **Required**: YES
- **Value**: Must be exactly `prod`

### 2. DATABASE_URL
```bash
DATABASE_URL=postgresql://postgres:xxxxx@xxxx.railway.app:5432/railway
```
- **Status**: [ ] SET / [ ] MISSING
- **Purpose**: PostgreSQL connection string
- **Required**: YES
- **Source**: Auto-generated by Railway PostgreSQL plugin
- **Note**: Should be automatically set when PostgreSQL service is linked

### 3. APP_SECURITY_JWT_SECRET
```bash
APP_SECURITY_JWT_SECRET=your-super-secret-jwt-key-min-256-bits
```
- **Status**: [ ] SET / [ ] MISSING
- **Purpose**: JWT token signing secret
- **Required**: YES
- **Minimum Length**: 32 characters (256 bits recommended: 64+ characters)
- **Security**: Must be cryptographically secure random string

**Generate a secure secret (choose one method):**

**Option 1: OpenSSL**
```bash
openssl rand -base64 64
```

**Option 2: Node.js**
```bash
node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
```

**Option 3: PowerShell**
```powershell
-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 64 | ForEach-Object {[char]$_})
```

**Option 4: Online Generator**
- Visit: https://www.grc.com/passwords.htm
- Use the 63 character password

### 4. JWT_ACCESS_TTL_SECONDS
```bash
JWT_ACCESS_TTL_SECONDS=86400
```
- **Status**: [ ] SET / [ ] MISSING
- **Purpose**: JWT token expiration time (in seconds)
- **Required**: NO (has default: 86400)
- **Recommended**: 86400 (24 hours)
- **Options**:
  - 3600 = 1 hour (high security)
  - 86400 = 24 hours (recommended)
  - 604800 = 7 days (convenience)

### 5. PORT
```bash
PORT=8080
```
- **Status**: [ ] SET / [ ] MISSING
- **Purpose**: HTTP server port
- **Required**: NO
- **Source**: Auto-managed by Railway
- **Note**: Railway automatically assigns and injects this

---

## üîó POSTGRESQL SERVICE LINK

### Verify PostgreSQL Plugin is Connected

1. In Railway dashboard, check **"Services"**
2. You should see:
   - `sgms-backend` (your Spring Boot app)
   - `PostgreSQL` (database plugin)
3. Verify they are linked (connection line between them)

**If PostgreSQL is NOT linked:**
1. Click `sgms-backend` service
2. Click **"Settings"** ‚Üí **"Plugins"**
3. Add **PostgreSQL** plugin
4. Railway will auto-generate `DATABASE_URL`

---

## üö® CRITICAL ACTIONS REQUIRED

### If APP_SECURITY_JWT_SECRET is Missing or Weak

**Current Status**: ‚ö†Ô∏è NEEDS VERIFICATION

**Action Required**:
1. Generate a secure secret using one of the methods above
2. Copy the generated string
3. In Railway dashboard:
   - Go to **Variables** tab
   - Click **"New Variable"**
   - Name: `APP_SECURITY_JWT_SECRET`
   - Value: [paste your generated secret]
   - Click **"Add"**
4. Railway will auto-redeploy your app

**Security Warning**: 
- If this secret changes, ALL existing JWT tokens become invalid
- All users will be logged out
- This is acceptable for initial setup
- In production, changing this requires a migration strategy

---

## üéØ POST-VERIFICATION STEPS

After setting all variables:

### 1. Check Deployment Logs
```
Railway Dashboard ‚Üí sgms-backend ‚Üí Deployments ‚Üí Latest ‚Üí View Logs
```

Look for:
- ‚úÖ `Started SgmsBackendApplication in X.XXX seconds`
- ‚úÖ `Tomcat started on port(s): 8080`
- ‚ùå Any error messages about missing environment variables

### 2. Test Health Endpoint
```bash
curl https://sgms-backend-production.up.railway.app/actuator/health
```

Expected response:
```json
{
  "status": "UP"
}
```

### 3. Test Login Endpoint
```bash
curl -X POST https://sgms-backend-production.up.railway.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@zplusesecurity.com",
    "password": "your_password"
  }'
```

Expected: Should return JWT token (or 401 if credentials wrong)

---

## üìä ENVIRONMENT VARIABLE SUMMARY

| Variable | Required | Auto-Set | Action Needed |
|----------|----------|----------|---------------|
| SPRING_PROFILES_ACTIVE | ‚úÖ YES | ‚ùå | Set to `prod` |
| DATABASE_URL | ‚úÖ YES | ‚úÖ (if PostgreSQL linked) | Verify exists |
| APP_SECURITY_JWT_SECRET | ‚úÖ YES | ‚ùå | Generate & set |
| JWT_ACCESS_TTL_SECONDS | ‚ö†Ô∏è Optional | ‚ùå | Set to `86400` (recommended) |
| PORT | ‚ö†Ô∏è Optional | ‚úÖ | No action |

---

## üîç TROUBLESHOOTING

### Issue: App fails to start with "DATABASE_URL not found"
**Solution**: 
- Add PostgreSQL plugin to your Railway project
- Link it to sgms-backend service

### Issue: App fails with "JWT secret must be at least 32 characters"
**Solution**:
- Generate a longer secret (64+ characters)
- Ensure no extra spaces when pasting into Railway

### Issue: App starts but login returns 500 error
**Possible Causes**:
1. Database tables not created (run migrations)
2. JWT secret too short
3. Database connection issue

**Check Logs**:
```
Railway ‚Üí Deployments ‚Üí View Logs
```

---

## ‚úÖ COMPLETION CHECKLIST

After verifying/setting all variables:

- [ ] SPRING_PROFILES_ACTIVE = prod
- [ ] DATABASE_URL exists (auto-generated)
- [ ] APP_SECURITY_JWT_SECRET set (64+ chars)
- [ ] JWT_ACCESS_TTL_SECONDS = 86400
- [ ] PostgreSQL service linked
- [ ] Latest deployment successful
- [ ] Health check returns UP
- [ ] Login endpoint tested
- [ ] No errors in deployment logs

**Once all items checked, Phase 0.1 Security (Backend) is complete!**

---

**Document Version**: 1.0  
**Last Updated**: February 18, 2026  
